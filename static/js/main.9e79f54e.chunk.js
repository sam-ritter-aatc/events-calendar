(this["webpackJsonpcalendar-events"]=this["webpackJsonpcalendar-events"]||[]).push([[0],{138:function(e,t){var n=function(e){var t=Object.assign({},e);if(e.Sessions){var n=[];return e.Sessions.forEach((function(e){var a=Object.assign({},t);a.Id=e.Id,a.parentId=t.Id,a.Title=e.Title,a.StartDate=e.StartDate,a.EndDate=e.EndDate,a.StartTimeSpecified=e.StartTimeSpecified,a.EndTimeSpecified=e.EndTimeSpecified,a.isRecurringSession=!0,a.isOrganizedEvent=e.Details&&e.Details.Organizer,delete a.Sessions,n.push(a)})),n}return t};e.exports=function(e){var t=[];return Array.isArray(e)?e.forEach((function(e){var a=n(e);Array.isArray(a)?a.forEach((function(e){t.push(e)})):t.push(a)})):t.push(n(e)),t}},152:function(e,t,n){e.exports=n(310)},157:function(e,t,n){},158:function(e,t,n){},194:function(e,t,n){},214:function(e,t,n){},225:function(e,t){},227:function(e,t){},250:function(e,t,n){},251:function(e,t,n){},309:function(e,t,n){},310:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(24),o=n.n(s),i=(n(157),n(90)),c=n(14),l=(n(158),n(5)),u=n.n(l),h=n(9),d=n(19),v=n(20),m=n(22),p=n(21),g=n(32),f=function(e){return"https://cors-anywhere.herokuapp.com/https://api.wildapricot.org/v2/accounts/"+e.Permissions[0].AccountId},E=function(e){return e.token_type+" "+e.access_token},b=function(e){return{"Content-Type":"application/json",Authorization:E(e)}},D=n(54),S=function(e){return f(e)+"/events"},y=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("creating new event",n),e.next=3,D.post(S(t),n,{headers:b(t)}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),O=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("creating new event",a),e.next=3,D.put(S(t)+"/"+n,a,{headers:b(t)}).then((function(e){console.log("RESULT",e),r(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),r({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting event",n),e.next=3,D.delete(S(t)+"/"+n,{headers:b(t)}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),T=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getEventById",n),e.next=3,D({url:S(t)+"/"+n,method:"GET",headers:b(t)}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),a({})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),C=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.get(S(t),{headers:b(t),params:{$filter:"StartDate ge "+n}}).then((function(e){a(e.data.Events)})).catch((function(e){console.log("Error",e),a([])}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),I=n(138),w=n.n(I),j=function(e,t){var n=Object.assign({},e),a=e.Sessions.filter((function(e){return e.Id===Number(t)}));return console.log("foundSession",a),a&&(n.sessionId=a[0].Id,n.Name=a[0].Title,n.StartDate=a[0].StartDate,n.EndDate=a[0].EndDate),console.log("theEvent",n),n},x=function(e,t,n){return r.a.createElement(c.a,{to:{pathname:e,state:{member:t,eventInfo:n}},push:!0})},N=n(140),R=n(45),A=n(141),L=n(142),G=n(143),M=n(144),H=n(145),z=n.n(H),P=(n(194),n(54)),F=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.get(f(t)+"/contacts/"+n,{headers:{"Content-Type":"application/json",Authorization:E(t)}}).then((function(e){var t={};t.id=e.data.Id,t.firstName=e.data.FirstName,t.lastName=e.data.LastName,t.email=e.data.Email,t.displayName=e.data.DisplayName,t.isAdmin=U(e.data.FieldValues),t.url=e.data.Url,a(t)})).catch((function(e){a(null)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),U=function(e){var t=e.filter((function(e){return"AdminRole"===e.SystemCode}));return t.length>0&&t[0].Value.length>0},B=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).createEvent=function(){a.setState({editEvent:!0,eventInfo:{}})},a.handleEventClick=function(e){console.log("going to event",e),a.setState({showEvent:!0,eventInfo:e})},a.handleDateClick=function(e){console.log("DATE CLICKED",e),a.setState({editEvent:!0,eventInfo:e})},a.calendarComponentRef=r.a.createRef(),a.state={events:[],member:null,calendarWeekends:!0,waToken:{},showEvent:!1,editEvent:!1,xid:e.match.params.xid},a}return Object(v.a)(n,[{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n,a=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z.a.parse(this.props.location.search),console.log("QUERY_PARAMS",this.props.location.search,t),(n=new Date).setFullYear(n.getFullYear()-1),n.setMonth(n.getMonth()-6),console.log("FIRST DATE",n),e.next=8,Object(g.a)((function(e){return a.setState({waToken:e})}));case 8:if(!t.mid||"0"===t.mid){e.next=12;break}return e.next=11,F(this.state.waToken,t.mid,(function(e){a.setState({member:e})}));case 11:console.log("Retrieve Member",this.state.member);case 12:return e.next=14,C(this.state.waToken,n.toISOString(),(function(e){var t=w()(e).map((function(e){return{id:e.Id,title:e.Name.replace("Weekly Workout - ","").replace("Weekly Workout- ",""),start:e.StartDate,end:e.EndDate,Url:e.Url,Tags:e.Tags,backgroundColor:a.getEventColor(e),parentId:e.parentId}}));a.setState({events:t})}));case 14:console.log("EVENTS",this.state.events);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getEventColor",value:function(e){return/Race/.test(e.Name)?"red":e.Tags&&e.Tags.indexOf("member-event")>-1?"green":"blue"}},{key:"render",value:function(){return this.state.showEvent?x("showEvent",this.state.member,this.state.eventInfo):this.state.editEvent?x("createEvent",this.state.member,this.state.eventInfo):r.a.createElement("div",{className:"EventCalendar"},r.a.createElement(N.a,{defaultView:"dayGridMonth",firstDay:1,fixedWeekCount:!1,header:{left:"prev today next",center:"title",right:"dayGridMonth,timeGridWeek,listMonth"},plugins:[R.d,A.a,M.a,L.a,G.a],themeSystem:"bootstrap",displayEventTime:!0,selectable:!0,ref:this.calendarComponentRef,weekends:this.state.calendarWeekends,events:this.state.events,dateClick:this.handleDateClick,eventClick:this.handleEventClick}),r.a.createElement("button",{onClick:this.createEvent},"Create Event"))}}]),n}(a.Component),V=n(150),W=n(11),_=n(34),Y=n(146),q=n.n(Y),J=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"loader"},r.a.createElement("h1",null,this.props.name),r.a.createElement("h2",null,"Loading"),r.a.createElement(q.a,{type:"ThreeDots",color:"#2BAD60",height:"100",width:"100"}))}}]),n}(a.Component),K=(n(214),n(54)),$=function(e){return f(e)+"/eventregistrations"},Q=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting registrations for eventId",n),e.next=3,K.get($(t)+"?eventId="+n,{headers:b(t)}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),X=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a,r){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null,e.next=3,ae(t,n,(function(e){s=e[0].Id}));case 3:return e.next=5,re(t,s,n,(function(e){console.log("updated registration type",e)}));case 5:return e.next=7,ee(t,n,a,s,r);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),Z=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a,r){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("registering user for event",n,a),s=null,e.next=4,ae(t,n,(function(e){s=e[0].Id}));case 4:return e.next=6,ee(t,n,a,s,r);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),ee=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a,r,s){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.post($(t),se(n,a,"",0,r),{headers:b(t)}).then((function(e){console.log("RESULT",e),s(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),s({err:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a,r,s){return e.apply(this,arguments)}}(),te=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("unregistering",n),e.next=3,K.delete($(t)+"/"+n,{headers:b(t)}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ne=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=se(n.eventId,n.memberId,n.message,n.numGuests)).Id=n.regId,r.RegistrationDate=n.dateRegistered,e.next=5,K.put($(t)+"/"+n.regId,r,{headers:b(t)}).then((function(e){console.log("RESULT",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),a({err:e})}));case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ae=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.get(f(t)+"/EventRegistrationTypes?eventId="+n,{headers:b(t)}).then((function(e){console.log("registrationTypes result",e),a(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),a({err:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),re=function(){var e=Object(h.a)(u.a.mark((function e(t,n,a,r){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=oe(n,a),e.next=3,K.put(f(t)+"/EventRegistrationTypes/"+n,s,{headers:b(t)}).then((function(e){console.log("registrationTypes result",e),r(e.data)})).catch((function(e){console.log("## Error ##",e),console.log("error",e),r({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),se=function(e,t,n,a,r){return{Event:{Id:e},Contact:{Id:t},RegistrationTypeId:r,GuestRegistrationsSummary:{NumberOfGuests:a,NumberOfGuestsCheckedIn:0},IsCheckedIn:!1,ShowToPublic:!0,RegistrationDate:new Date,Memo:n,RecreateInvoice:!1}},oe=function(e,t){return{Id:e,EventId:t,IsEnabled:!0,Description:"",BasePrice:0,GuestPrice:0,UseTaxScopeSettings:null,Availability:"Everyone",AvailableForMembershipLevels:null,GuestRegistrationPolicy:"NumberOfGuests",CurrentRegistrantsCount:0,MultipleRegistrationAllowed:!1,UnavailabilityPolicy:"Undefined",CancellationBehaviour:"DoNotAllow",CancellationDaysBeforeEvent:null,IsWaitlistEnabled:!1,Name:"RSVP"}},ie=n(147),ce=n.n(ie),le=n(46),ue=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={fetch:!0,eventId:"",waToken:{},url:"",event:null,organizer:null,modalToggle:!1,rsvpMessage:""},a.toggle=a.toggle.bind(Object(W.a)(a)),a.onChangeRsvpMessage=a.onChangeRsvpMessage.bind(Object(W.a)(a)),a}return Object(v.a)(n,[{key:"toggle",value:function(){this.setState({modalToggle:!this.state.modalToggle})}},{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)((function(e){return t.setState({waToken:e})}));case 2:if(console.log("EVENT DETAILS",this.props.location.state),this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),console.log("STATE",this.state),!this.state.eventInfo.event.extendedProps.parentId||!this.state.fetch){e.next=10;break}return e.next=8,T(this.state.waToken,this.state.eventInfo.event.extendedProps.parentId,(function(e){t.setState({event:j(e,t.state.eventInfo.event.id)})}));case 8:e.next=12;break;case 10:return e.next=12,T(this.state.waToken,this.state.eventInfo.event.id,(function(e){t.setState({event:e})}));case 12:return e.next=14,Q(this.state.waToken,this.state.eventInfo.event.id,(function(e){var n=e.map((function(e){return t.convertRegistrationData(e)}));t.setState({registrations:n})}));case 14:if(this.setState({fetch:!1}),console.log("state",this.state),!(this.state.event&&this.state.event.Details&&this.state.event.Details.Organizer)){e.next=20;break}return e.next=19,F(this.state.waToken,this.state.event.Details.Organizer.Id,(function(e){t.setState({organizer:e}),console.log("=====ORG",e,t.state.organizer)}));case 19:console.log("contact",this.state.organizer);case 20:console.log("state",this.state),console.log("CAN EDIT",this.canEdit());case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"convertRegistrationData",value:function(e){return console.log("CONVERT REG",e),{regId:e.Id,memberId:e.Contact.Id,eventId:e.Event.Id,name:e.DisplayName,message:e.Memo,numGuests:e.GuestRegistrationsSummary.NumberOfGuests,dateRegistered:e.RegistrationDate}}},{key:"handleEditClick",value:function(){this.setState({editEvent:!0})}},{key:"canEdit",value:function(){return this.state.member&&void 0===this.state.eventInfo.event.extendedProps.parentId&&(this.state.member.isAdmin||this.isUserEventOrganizer())}},{key:"isUserEventOrganizer",value:function(){return this.state.event.Details&&this.state.event.Details.Organizer&&this.state.member.id===this.state.event.Details.Organizer.Id}},{key:"notAlreadyRegistered",value:function(){var e=this;return this.state.member&&0===this.state.registrations.filter((function(t){return e.state.member.id===t.memberId})).length}},{key:"handleRegisterClick",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z(this.state.waToken,this.state.event.Id,this.state.member.id,(function(e){console.log("registration response",e),t.setState((function(n){return{registrations:[t.convertRegistrationData(e)].concat(Object(V.a)(n.registrations))}}))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleUnRegisterClick",value:function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(this.state.waToken,t,(function(e){}));case 2:this.setState((function(e){return{registrations:e.registrations.filter((function(e){return e.regId!==t}))}}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAddGuest",value:function(){var e=Object(h.a)(u.a.mark((function e(t){var n,a=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.findRegistrationByRegId(t)).numGuests=n.numGuests+1,e.next=4,ne(this.state.waToken,n,(function(e){console.log("ADDED GUEST",e),a.updateRegistrationInState(n,e)}));case 4:console.log("STATE",this.state);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAddMessage",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=Object.assign({},this.state.registration)).message=this.state.rsvpMessage,e.next=4,ne(this.state.waToken,t,(function(e){console.log("DATA from add MEssage",e),n.updateRegistrationInState(t,e)}));case 4:this.setState({registration:null,rsvpMessage:""}),this.toggle(),console.log("SAVED MESSAGE");case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateRegistrationInState",value:function(e,t){var n=this;this.setState((function(a){console.log("REGISTRATION convertedDAta",n.convertRegistrationData(t));var r=a.registrations.map((function(a){return a.regId===e.regId?n.convertRegistrationData(t):a}));return console.log("REGISTRATION",r),{registrations:r}}))}},{key:"addMessageModal",value:function(e){var t=this.findRegistrationByRegId(e);this.setState({registration:t,rsvpMessage:t.message}),this.toggle()}},{key:"onChangeRsvpMessage",value:function(e){this.setState({rsvpMessage:e.target.value})}},{key:"findRegistrationByRegId",value:function(e){var t=this.state.registrations.filter((function(t){return t.regId===e}));return 1===t.length?t[0]:null}},{key:"renderRegistrationData",value:function(){var e=this;return this.state.registrations.map((function(t,n){var a=t.regId,s=t.memberId,o=t.name,i=t.message,c=t.numGuests,l=t.dateRegistered;return r.a.createElement("tr",{key:a},r.a.createElement("td",null,a),r.a.createElement("td",null,o),r.a.createElement("td",null,c),r.a.createElement("td",null,l),r.a.createElement("td",null,i),r.a.createElement("td",{style:{display:"inline-block"}},s===e.state.member.id&&!e.isUserEventOrganizer()&&r.a.createElement(_.Button,{xs:!0,btnStyle:"danger",onClick:function(){return e.handleUnRegisterClick(a)}},"Unregister"),s===e.state.member.id&&r.a.createElement(_.Button,{xs:!0,btnStyle:"secondary",onClick:function(){return e.handleAddGuest(a)}},"Add Guest"),s===e.state.member.id&&r.a.createElement(_.Button,{xs:!0,btnStyle:"secondary",onClick:function(){return e.addMessageModal(a)}},"Add/Edit Message")))}))}},{key:"render",value:function(){var e=this;return this.state.fetch?r.a.createElement(J,{name:this.props.location.state.name}):this.state.editEvent?x("editEvent",this.state.member,this.state.eventInfo):r.a.createElement("div",null,this.canEdit()&&r.a.createElement(_.Button,{xs:!0,btnStyle:"primary",onClick:function(){return e.handleEditClick()}},"Edit Event"),this.notAlreadyRegistered()&&r.a.createElement(_.Button,{xs:!0,btnStyle:"success",onClick:function(){return e.handleRegisterClick()}},"RSVP"),r.a.createElement("h2",null,this.state.event.Name),r.a.createElement("div",{className:"event_id"},r.a.createElement("label",null,"Event Id: "),this.state.event.Id),r.a.createElement("div",{className:"event-title"},r.a.createElement("label",null,"Event Name: "),this.state.event.Name),r.a.createElement("div",{className:"event-start"},r.a.createElement("label",null,"Event Start Date/Time: "),this.state.event.StartDate),r.a.createElement("div",{className:"event-end"},r.a.createElement("label",null,"Event End Date/Time: "),this.state.event.EndDate),r.a.createElement("div",{className:"location"},r.a.createElement("label",null,"Event Location: "),this.state.event.Location),this.state.organizer&&r.a.createElement("div",{className:"organizer"},r.a.createElement("label",null,"Organizer: "),this.state.organizer.displayName+"("+this.state.organizer.email+")"),r.a.createElement("div",{className:"descriptionHtml"},r.a.createElement("label",null,"Description: "),r.a.createElement("br",null),r.a.createElement("div",null,ce()(this.state.event.Details.DescriptionHtml))),r.a.createElement("div",{className:"registrations"},r.a.createElement("label",null,"Registrations: "),r.a.createElement("br",null),r.a.createElement("table",{id:"registrations",className:"table-striped"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Registration Id"),r.a.createElement("th",{scope:"col"},"Name"),r.a.createElement("th",{scope:"col"},"#Guests"),r.a.createElement("th",{scope:"col"},"Date Registered"),r.a.createElement("th",{scope:"col"},"Message"),r.a.createElement("th",{scope:"col"})),this.renderRegistrationData()))),r.a.createElement(le.a,{show:this.state.modalToggle,onHide:this.toggle,size:"lg",backdrop:"static","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(le.a.Header,{closeButton:!0},r.a.createElement(le.a.Title,{id:"contained-modal-title-vcenter"},"RSVP Message")),r.a.createElement(le.a.Body,null,r.a.createElement("h4",null,"Please enter your message:"),r.a.createElement("p",null,r.a.createElement("input",{type:"text",value:this.state.rsvpMessage,className:"form-control",onChange:this.onChangeRsvpMessage}))),r.a.createElement(le.a.Footer,null,r.a.createElement(_.Button,{xs:!0,btnStyle:"danger",onClick:this.toggle},"Cancel"),r.a.createElement(_.Button,{xs:!0,onClick:function(){return e.handleAddMessage()}},"Save"))))}}]),n}(a.Component),he=n(8),de=n(62),ve=n.n(de),me=n(63),pe=n.n(me),ge=(n(250),n(37)),fe=n.n(ge),Ee=(n(251),n(151));Object(ge.registerLocale)("en-GB",Ee.a),Object(ge.setDefaultLocale)("en-GB");var be=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(d.a)(this,n),a=t.call(this,e),console.log("PROPS",e),a.state={startDate:new Date(a.props.startDate.getTime()),endDate:new Date(a.props.endDate.getTime()),maxDate:a.props.endDate?new Date(new Date(a.props.endDate.getTime()).setHours(23,59,59)):null,minDate:a.props.startDate?new Date(new Date(a.props.startDate.getTime()).setHours(0,0,0)):null},a.onChangeStartDate=a.onChangeStartDate.bind(Object(W.a)(a)),a.onChangeStartTime=a.onChangeStartTime.bind(Object(W.a)(a)),a.onChangeEndTime=a.onChangeEndTime.bind(Object(W.a)(a)),a}return Object(v.a)(n,[{key:"onChangeStartDate",value:function(){var e=Object(h.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()),console.log("Date from component",t,n),e.next=4,this.setState({startDate:n,endDate:new Date(this.state.endDate.setFullYear(t.getFullYear(),t.getMonth(),t.getDate())),minDate:new Date(t.setHours(0,0,0)),maxDate:new Date(t.setHours(23,59,59))});case 4:console.log("DTR STATE",this.state),console.log("CHILD ONCHANGE",t),this.props.onChangeStartDate(this.state.startDate),this.props.onChangeEndDate(this.state.endDate);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeStartTime",value:function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.endDate<this.state.startDate)){e.next=5;break}return e.next=3,this.setState({startDate:t,endDate:t});case 3:e.next=7;break;case 5:return e.next=7,this.setState({startDate:t});case 7:this.props.onChangeStartDate(this.state.startDate),this.props.onChangeEndDate(this.state.endDate),console.log("State after start time change",this.state);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeEndTime",value:function(e){this.setState({endDate:e}),this.props.onChangeEndDate(e)}},{key:"componentDidUpdate",value:function(e,t,n){this.state.startDate===t.startDate&&this.state.endDate===t.endDate||this.render()}},{key:"render",value:function(){return this.renderComponent()}},{key:"renderComponent",value:function(){var e=this;return r.a.createElement("div",{className:"dateTimeRangeSelector"},r.a.createElement("div",{className:"dateTimeRangeSelector-date"},r.a.createElement("label",null,this.props.dateLabel),r.a.createElement(fe.a,{selected:this.props.startDate,placeholderText:"Click to select a date",onChange:function(t){return e.onChangeStartDate(t)}})),r.a.createElement("div",{className:"dateTimeRangeSelector-start"},r.a.createElement("label",null,this.props.startLabel),r.a.createElement(fe.a,{selected:this.props.startDate,onChange:function(t){return e.props.onChangeStartDate(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,minTime:this.state.minDate,maxTime:this.state.endDate,timeCaption:"Start Time",dateFormat:"h:mm aa"})),r.a.createElement("div",{className:"dateTimeRangeSelector-end"},r.a.createElement("label",null,this.props.endLabel),r.a.createElement(fe.a,{selected:this.props.endDate,onChange:function(t){return e.onChangeEndTime(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,minTime:this.state.startDate,maxTime:this.state.maxDate,timeCaption:"End Time",dateFormat:"h:mm aa"})))}}]),n}(a.Component),De=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).handleStartChange=function(){var e=Object(h.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({date:Object(he.a)(Object(he.a)({},a.state.date),{},{date:t})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),console.log("INCOMING PROPS",e),a.state={event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""},isEditing:!0,eventInfo:e.location.state.eventInfo,member:e.location.state.member,fetch:!0},a.onSubmit=a.onSubmit.bind(Object(W.a)(a)),a.onChangeEventLocation=a.onChangeEventLocation.bind(Object(W.a)(a)),a.onChangeEventName=a.onChangeEventName.bind(Object(W.a)(a)),a.startDateHandler=a.startDateHandler.bind(Object(W.a)(a)),a.endDateHandler=a.endDateHandler.bind(Object(W.a)(a)),a.handleDelete=a.handleDelete.bind(Object(W.a)(a)),a}return Object(v.a)(n,[{key:"onSubmit",value:function(e){e.preventDefault();var t=Object.assign({},this.state.event);console.log("SAVING EVENT",this.state,t),O(this.state.waToken,this.state.event.Id,this.state.event,(function(e){console.log("UPDATE RESULT",e)})),this.setState({event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""}}),this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"onChangeEventName",value:function(e){this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{Name:e.target.value})})}},{key:"onChangeEventLocation",value:function(e){this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{Location:e.target.value})})}},{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)((function(e){return n.setState({waToken:e})}));case 2:if(console.log("EVENT DETAILS",this.props.location.state),this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),console.log("STATE",this.state),!this.state.eventInfo.event||!this.state.fetch){e.next=15;break}if(!this.state.eventInfo.event.extendedProps.parentId||!this.state.fetch){e.next=11;break}return e.next=9,T(this.state.waToken,this.state.eventInfo.event.extendedProps.parentId,(function(e){n.setState({event:j(e,n.state.eventInfo.event.id)})}));case 9:e.next=13;break;case 11:return e.next=13,T(this.state.waToken,this.state.eventInfo.event.id,(function(e){n.setState({event:e})}));case 13:e.next=16;break;case 15:this.state.eventInfo.date&&this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{StartDate:new Date(this.state.eventInfo.date)})});case 16:if(this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{StartDate:new Date(this.state.event.StartDate)})}),this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{EndDate:new Date(this.state.event.EndDate)})}),console.log("===>state",this.state),this.setState({fetch:!1}),this.props.location.state.eventInfo.date&&(t=new Date(this.props.location.state.eventInfo.date.getTime()),this.setState(Object(he.a)(Object(he.a)({},this.state.event),{},{startDate:this.props.location.state.eventInfo.date})),this.setState(Object(he.a)(Object(he.a)({},this.state.event),{},{endDate:new Date(t.setHours(23,59,59))}))),!(this.state.event&&this.state.event.Details&&this.state.event.Details.Organizer)){e.next=25;break}return e.next=24,F(this.state.waToken,this.state.event.Details.Organizer.Id,(function(e){n.setState({organizer:e}),console.log("=====ORG",e,n.state.organizer)}));case 24:console.log("contact",this.state.organizer);case 25:console.log("state",this.state);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startDateHandler",value:function(e){console.log("CreatorState",this.state),this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{StartDate:e})})}},{key:"endDateHandler",value:function(e){console.log("CreatorState",this.state),this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{EndDate:e})})}},{key:"handleDelete",value:function(){console.log("Deleting Event",this.state.event.Id),k(this.state.waToken,this.state.event.Id,(function(e){console.log("DELETE RESULT",e)})),this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"render",value:function(){var e=this;return this.state.fetch?r.a.createElement(J,{name:this.props.location.state.name}):r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"editor"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Id: "),this.state.event.Id),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Name: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Name,onChange:this.onChangeEventName})),r.a.createElement("div",{className:"form-group"},r.a.createElement(be,{dateLabel:"Event Date: ",startLabel:"Start Time: ",endLabel:"End Time: ",startDate:this.state.event.StartDate,endDate:this.state.event.EndDate,onChangeStartDate:this.startDateHandler,onChangeEndDate:this.endDateHandler})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Location: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Location,onChange:this.onChangeEventLocation})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Description"),r.a.createElement(ve.a,{editor:pe.a,data:this.state.event.Details.DescriptionHtml,onChange:function(t,n){var a=e.state.event.Details;a.DescriptionHtml=n.getData(),e.setState({event:Object(he.a)(Object(he.a)({},e.state.event),{},{Details:a})})}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"submit",value:"Save Event",className:"btn btn-primary btn-sm"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"button",value:"Delete Event",className:"btn btn-danger btn-sm",onClick:this.handleDelete})))))}}]),n}(a.Component),Se=(n(309),function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(d.a)(this,n),a=t.call(this,e),console.log("INCOMING PROPS",e),a.state={event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""},isEditing:!0,eventInfo:e.location.state.eventInfo,member:e.location.state.member,fetch:!0},a.onSubmit=a.onSubmit.bind(Object(W.a)(a)),a.onChangeEventLocation=a.onChangeEventLocation.bind(Object(W.a)(a)),a.onChangeEventName=a.onChangeEventName.bind(Object(W.a)(a)),a.startDateHandler=a.startDateHandler.bind(Object(W.a)(a)),a.endDateHandler=a.endDateHandler.bind(Object(W.a)(a)),a}return Object(v.a)(n,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var n=Object.assign({},this.state.event);n.StartDate=n.StartDate.toISOString(),n.EndDate=n.EndDate.toISOString(),console.log("SAVING EVENT",this.state,n),y(this.state.waToken,n,(function(e){console.log("CREATE RESULT",e),X(t.state.waToken,e,t.state.member.id,(function(e){console.log("INITIAL REG",e)}))})),this.setState({event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""}}),this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"onChangeEventName",value:function(e){this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{Name:e.target.value})})}},{key:"onChangeEventLocation",value:function(e){this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{Location:e.target.value})})}},{key:"componentDidMount",value:function(){var e=Object(h.a)(u.a.mark((function e(){var t,n=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)((function(e){return n.setState({waToken:e})}));case 2:console.log("EVENT DETAILS",this.props.location.state),this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),console.log("STATE",this.state),this.state.eventInfo.date&&(this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{StartDate:new Date(new Date(this.state.eventInfo.date).setHours(8,0,0))})}),this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{EndDate:new Date(new Date(this.state.eventInfo.date).setHours(20,0,0))})})),this.setState({fetch:!1}),console.log("===>state",this.state),(t=Object.assign({},this.state.event.Details)).Organizer={Id:this.state.member.id},this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{Details:t})}),console.log("state",this.state);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startDateHandler",value:function(e){console.log("CreatorState-start",this.state),this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{StartDate:e})})}},{key:"endDateHandler",value:function(e){console.log("CreatorState-end",this.state),this.setState({event:Object(he.a)(Object(he.a)({},this.state.event),{},{EndDate:e})})}},{key:"componentDidUpdate",value:function(e,t,n){this.state.event.StartDate===t.event.StartDate&&this.state.event.EndDate===t.event.EndDate||this.render()}},{key:"render",value:function(){var e=this;return this.state.fetch?r.a.createElement(J,{name:this.props.location.state.name}):r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"editor"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Name: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Name,onChange:this.onChangeEventName})),r.a.createElement("div",{className:"form-group"},r.a.createElement(be,{dateLabel:"Event Date: ",startLabel:"Start Time: ",endLabel:"End Time: ",startDate:this.state.event.StartDate,endDate:this.state.event.EndDate,onChangeStartDate:this.startDateHandler,onChangeEndDate:this.endDateHandler})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Location: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Location,onChange:this.onChangeEventLocation})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Description"),r.a.createElement(ve.a,{editor:pe.a,data:this.state.event.Details.DescriptionHtml,onChange:function(t,n){var a=e.state.event.Details;a.DescriptionHtml=n.getData(),e.setState({event:Object(he.a)(Object(he.a)({},e.state.event),{},{Details:a})})}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"submit",value:"Create Event",className:"btn btn-primary btn-sm"})))))}}]),n}(a.Component));var ye=function(){return r.a.createElement(i.a,{basename:"/"},r.a.createElement("div",{className:"App container-fluid"},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"}),r.a.createElement(c.d,null,r.a.createElement(c.b,{exact:!0,path:"/:xid",component:B}),r.a.createElement(c.b,{exact:!0,path:"/showEvent",component:ue}),r.a.createElement(c.b,{exact:!0,path:"/editEvent",component:De}),r.a.createElement(c.b,{exact:!0,path:"/createEvent",component:Se}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ye,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},32:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var a=n(5),r=n.n(a),s=n(9),o=n(54),i=n(178),c=function(){var t=Object(s.a)(r.a.mark((function t(n){var a,s,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("url","https://cors-anywhere.herokuapp.com/https://oauth.wildapricot.org/auth/token"),console.log("key","mf8q984b3zem9x5r6rk19yg37ht6uz"),a="Basic "+new e("APIKEY:mf8q984b3zem9x5r6rk19yg37ht6uz").toString("base64"),s={grant_type:"client_credentials",scope:"auto",obtain_refresh_token:!0},c={headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:a}},t.next=7,o.post("https://cors-anywhere.herokuapp.com/https://oauth.wildapricot.org/auth/token",i.stringify(s),c).then((function(e){n(e.data)})).catch((function(e){console.log("error",e)}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}).call(this,n(53).Buffer)}},[[152,1,2]]]);
//# sourceMappingURL=main.9e79f54e.chunk.js.map