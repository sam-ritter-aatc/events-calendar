(this["webpackJsonpcalendar-events"]=this["webpackJsonpcalendar-events"]||[]).push([[0],{138:function(e,t){var n=function(e){var t=Object.assign({},e);if(e.Sessions){var n=[];return e.Sessions.forEach((function(e){var a=Object.assign({},t);a.Id=e.Id,a.parentId=t.Id,a.Title=e.Title,a.StartDate=e.StartDate,a.EndDate=e.EndDate,a.StartTimeSpecified=e.StartTimeSpecified,a.EndTimeSpecified=e.EndTimeSpecified,a.isRecurringSession=!0,a.isOrganizedEvent=e.Details&&e.Details.Organizer,delete a.Sessions,n.push(a)})),n}return t};e.exports=function(e){var t=[];return Array.isArray(e)?e.forEach((function(e){var a=n(e);Array.isArray(a)?a.forEach((function(e){t.push(e)})):t.push(a)})):t.push(n(e)),t}},152:function(e,t,n){e.exports=n(310)},157:function(e,t,n){},158:function(e,t,n){},194:function(e,t,n){},224:function(e,t){},226:function(e,t){},243:function(e,t,n){},250:function(e,t,n){},308:function(e,t,n){},309:function(e,t,n){},310:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(25),i=n.n(s),o=(n(157),n(19)),c=n(20),l=n(22),u=n(21),h=n(90),d=n(14),m=(n(158),n(5)),v=n.n(m),p=n(9),f=n(33),g=function(e){return"https://cors-anywhere.herokuapp.com/https://api.wildapricot.org/v2.2/accounts/"+e.Permissions[0].AccountId},b=function(e){return e.token_type+" "+e.access_token},E=function(e){return{"Content-Type":"application/json",Authorization:b(e)}},D=n(47),S=function(e){return g(e)+"/events"},y=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("creating new event",n),e.next=3,D({method:"POST",url:S(t),data:n,headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),k=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a,r){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("creating new event",a),e.next=3,D({method:"PUT",url:S(t)+"/"+n,data:a,headers:E(t)}).then((function(e){r(e.data)})).catch((function(e){r({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),O=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("deleting event",n),e.next=3,D({method:"DELETE",url:S(t)+"/"+n,headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),w=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D({url:S(t)+"/"+n,method:"GET",headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),x=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D({method:"GET",url:S(t),headers:E(t),params:{$filter:"StartDate ge "+n}}).then((function(e){a(e.data.Events)})).catch((function(e){a([])}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),C=n(138),I=n.n(C),T=function(e,t){var n=Object.assign({},e),a=e.Sessions.filter((function(e){return e.Id===Number(t)}));return a&&(n.sessionId=a[0].Id,n.Name=a[0].Title,n.StartDate=a[0].StartDate,n.EndDate=a[0].EndDate),n},j=function(e,t,n){return r.a.createElement(d.a,{to:{pathname:e,state:{member:t,eventInfo:n}},push:!0})},N=function(){var e=new Date;return e.setFullYear(e.getFullYear()-1),e.setMonth(e.getMonth()-6),console.log("FIRST DATE",e),e.toISOString()},R=n(140),L=n(45),A=n(141),M=n(142),G=n(143),P=n(144),B=n(145),H=n.n(B),z=n(15),F=n(47),U=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F({method:"GET",url:g(t)+"/contacts/"+n,headers:E(t)}).then((function(e){var t={};t.id=e.data.Id,t.firstName=e.data.FirstName,t.lastName=e.data.LastName,t.email=e.data.Email,t.displayName=e.data.DisplayName,t.isAdmin=V(e.data.FieldValues),t.url=e.data.Url,a(t)})).catch((function(e){a(null)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),V=function(e){var t=e.filter((function(e){return"AdminRole"===e.SystemCode}));return t.length>0&&t[0].Value.length>0},W=(n(194),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).createEvent=function(){a.setState({editEvent:a.state.isLoggedInUser,eventInfo:{}})},a.handleEventClick=function(e){a.setState({showEvent:!0,eventInfo:e})},a.handleDateClick=function(e){a.setState({editEvent:a.state.isLoggedInUser,eventInfo:e})},a.calendarComponentRef=r.a.createRef(),a.state={member:{id:0,isAdmin:!1},calendarWeekends:!0,waToken:{},showEvent:!1,editEvent:!1,xid:e.match.params.xid,isLoggedInUser:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=H.a.parse(this.props.location.search),e.next=3,Object(f.a)((function(e){return n.setState({waToken:e})}));case 3:if(!t.mid||"0"===t.mid){e.next=7;break}return e.next=6,U(this.state.waToken,t.mid,(function(e){n.setState({member:e})}));case 6:this.setState({isLoggedInUser:!0});case 7:return e.next=9,x(this.state.waToken,N(),(function(e){var t=I()(e).map((function(e){return{id:e.Id,title:e.Name.replace("Weekly Workout - ","").replace("Weekly Workout- ",""),start:e.StartDate,end:e.EndDate,Url:e.Url,Tags:e.Tags,backgroundColor:n.getEventColor(e),parentId:e.parentId}}));n.props.onEventChange(t),console.log("events have been reloaded")}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getEventColor",value:function(e){return/Race/.test(e.Name)?"red":e.Tags&&e.Tags.indexOf("member-event")>-1?"green":"blue"}},{key:"handleWindowResize",value:function(e){console.log("RESIZE",e),e.updateSize()}},{key:"render",value:function(){return this.state.showEvent?j("showEvent",this.state.member,this.state.eventInfo):this.state.editEvent?j("createEvent",this.state.member,this.state.eventInfo):r.a.createElement("div",{className:"EventCalendar"},r.a.createElement(R.a,{defaultView:"dayGridMonth",firstDay:1,fixedWeekCount:!1,handleWindowResize:!0,contentHeight:"auto",height:"auto",header:{left:"prev today next",center:"title",right:"dayGridMonth,timeGridWeek,listMonth"},plugins:[L.d,A.a,P.a,M.a,G.a],themeSystem:"bootstrap",displayEventTime:!0,selectable:!0,ref:this.calendarComponentRef,weekends:this.state.calendarWeekends,events:this.props.events,dateClick:this.handleDateClick,eventClick:this.handleEventClick,windowResize:this.handleWindowResize}),this.state.isLoggedInUser?r.a.createElement(z.Button,{xs:!0,onClick:this.createEvent},"Create Event"):r.a.createElement("div",null," "))}}]),n}(a.Component)),_=n(150),Y=n(11),J=n(146),$=n.n(J),q=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"loader"},r.a.createElement("h1",null,this.props.name),r.a.createElement("h2",null,"Loading"),r.a.createElement($.a,{type:"ThreeDots",color:"#2BAD60",height:"100",width:"100"}))}}]),n}(a.Component),K=n(47),Z=function(e){return g(e)+"/eventregistrations"},Q=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({method:"GET",url:Z(t)+"?eventId="+n,headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({err:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),X=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a,r){var s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null,e.next=3,re(t,n,(function(e){s=e[0].Id}));case 3:return e.next=5,se(t,s,n,(function(e){console.log("updated registration type",e)}));case 5:return e.next=7,te(t,n,a,s,r);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),ee=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a,r){var s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("registering user for event",n,a),s=null,e.next=4,re(t,n,(function(e){s=e[0].Id}));case 4:return e.next=6,te(t,n,a,s,r);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),te=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a,r,s){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({method:"POST",url:Z(t),data:ie(n,a,"",0,r),headers:E(t)}).then((function(e){s(e.data)})).catch((function(e){s({err:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a,r,s){return e.apply(this,arguments)}}(),ne=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("unregistering",n),e.next=3,K({method:"DELETE",url:Z(t)+"/"+n,headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ae=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=ie(n.eventId,n.memberId,n.message,n.numGuests)).Id=n.regId,r.RegistrationDate=n.dateRegistered,e.next=5,K({method:"PUT",url:Z(t)+"/"+n.regId,data:r,headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({err:e})}));case 5:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),re=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K({method:"GET",url:g(t)+"/EventRegistrationTypes?eventId="+n,headers:E(t)}).then((function(e){a(e.data)})).catch((function(e){a({err:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),se=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a,r){var s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=oe(n,a),e.next=3,K({method:"PUT",url:g(t)+"/EventRegistrationTypes/"+n,data:s,headers:E(t)}).then((function(e){r(e.data)})).catch((function(e){r({err:e})}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),ie=function(e,t,n,a,r){return{Event:{Id:e},Contact:{Id:t},RegistrationTypeId:r,GuestRegistrationsSummary:{NumberOfGuests:a,NumberOfGuestsCheckedIn:0},IsCheckedIn:!1,ShowToPublic:!0,RegistrationDate:new Date,Memo:n,RecreateInvoice:!1}},oe=function(e,t){return{Id:e,EventId:t,IsEnabled:!0,Description:"",BasePrice:0,GuestPrice:0,UseTaxScopeSettings:null,Availability:"Everyone",AvailableForMembershipLevels:null,GuestRegistrationPolicy:"NumberOfGuests",CurrentRegistrantsCount:0,MultipleRegistrationAllowed:!1,UnavailabilityPolicy:"Undefined",CancellationBehaviour:"DoNotAllow",CancellationDaysBeforeEvent:null,IsWaitlistEnabled:!1,Name:"RSVP"}},ce=n(47),le=function(e){return"https://cors-anywhere.herokuapp.com/https://api.wildapricot.org/v2.2/rpc/"+e.Permissions[0].AccountId+"/email/SendEmail"},ue=function(){var e=Object(p.a)(v.a.mark((function e(t,n,a,r,s,i){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce({method:"POST",url:le(t),data:he(n,a,r,s),headers:E(t)}).then((function(e){i(e.data)})).catch((function(e){i({err:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t,n,a,r,s,i){return e.apply(this,arguments)}}(),he=function(e,t,n,a){return{Subject:n,Body:a,Recipients:de(t),EventId:e}},de=function(e){return e.map((function(e){return{Id:e.memberId,Type:"IndividualContactRecipient"}}))},me=n(147),ve=n.n(me),pe=n(46),fe=(n(243),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={fetch:!0,eventId:"",waToken:{},url:"",event:null,organizer:null,modalToggle:!1,rsvpMessage:"",rsvpModalTitle:"",modalTextBoxType:""},a.toggle=a.toggle.bind(Object(Y.a)(a)),a.onChangeRsvpMessage=a.onChangeRsvpMessage.bind(Object(Y.a)(a)),a}return Object(c.a)(n,[{key:"calendarViewClick",value:function(){this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"toggle",value:function(){this.setState({modalToggle:!this.state.modalToggle})}},{key:"componentDidMount",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)((function(e){return t.setState({waToken:e})}));case 2:return this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),e.next=5,this.getEvent();case 5:return e.next=7,Q(this.state.waToken,this.state.eventInfo.event.id,(function(e){var n=e.map((function(e){return t.convertRegistrationData(e)}));t.setState({registrations:n})}));case 7:if(this.setState({fetch:!1}),!(this.state.event&&this.state.event.Details&&this.state.event.Details.Organizer)){e.next=11;break}return e.next=11,U(this.state.waToken,this.state.event.Details.Organizer.Id,(function(e){t.setState({organizer:e})}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getEvent",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.eventInfo.event.extendedProps.parentId||!this.state.fetch){e.next=5;break}return e.next=3,w(this.state.waToken,this.state.eventInfo.event.extendedProps.parentId,(function(e){t.setState({event:T(e,t.state.eventInfo.event.id)})}));case 3:e.next=7;break;case 5:return e.next=7,w(this.state.waToken,this.state.eventInfo.event.id,(function(e){t.setState({event:e})}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"convertRegistrationData",value:function(e){return{regId:e.Id,memberId:e.Contact.Id,eventId:e.Event.Id,name:e.DisplayName,message:e.Memo,numGuests:e.GuestRegistrationsSummary&&e.GuestRegistrationsSummary.NumberOfGuests?e.GuestRegistrationsSummary.NumberOfGuests:0,dateRegistered:e.RegistrationDate}}},{key:"handleEditClick",value:function(){this.setState({editEvent:!0})}},{key:"canEdit",value:function(){return this.state.member&&void 0===this.state.eventInfo.event.extendedProps.parentId&&(this.state.member.isAdmin||this.isUserEventOrganizer())}},{key:"isUserEventOrganizer",value:function(){return this.state.event.Details&&this.state.event.Details.Organizer&&this.state.member.id===this.state.event.Details.Organizer.Id}},{key:"notAlreadyRegistered",value:function(){var e=this;return this.state.member&&0===this.state.registrations.filter((function(t){return e.state.member.id===t.memberId})).length}},{key:"handleRegisterClick",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(this.state.waToken,this.state.event.Id,this.state.member.id,(function(e){t.setState((function(n){return{registrations:[t.convertRegistrationData(e)].concat(Object(_.a)(n.registrations))}}))}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleUnRegisterClick",value:function(){var e=Object(p.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(this.state.waToken,t,(function(e){}));case 2:this.setState((function(e){return{registrations:e.registrations.filter((function(e){return e.regId!==t}))}}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAddGuest",value:function(){var e=Object(p.a)(v.a.mark((function e(t){var n,a=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.findRegistrationByRegId(t)).numGuests=n.numGuests+1,e.next=4,ae(this.state.waToken,n,(function(e){a.updateRegistrationInState(n,e)}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAddMessage",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=Object.assign({},this.state.registration)).message=this.state.rsvpMessage,e.next=4,ae(this.state.waToken,t,(function(e){n.updateRegistrationInState(t,e)}));case 4:this.setState({registration:null,rsvpMessage:""}),this.toggle();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleMessagingClick",value:function(){var e=Object(p.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({rsvpModalTitle:"Message to RSVP Contacts",modalTextBoxType:"textarea"});case 2:this.toggle();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSendMessage",value:function(){var e=Object(p.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ue(this.state.waToken,this.state.event.Id,this.state.registrations,this.messageSubject(),this.memberMessage(),(function(e){return console.log(e)})),e.next=3,this.setState({rsvpModalTitle:"",rsvpMessage:"",modalTextBoxType:"text"});case 3:this.toggle();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"messageSubject",value:function(){return"Event Update: "+this.state.event.Name+"  "+new Date(this.state.event.StartDate).toLocaleString()}},{key:"memberMessage",value:function(){return"<html><body>This is concerning the event you RSVP'd to on: "+new Date(this.state.event.StartDate).toLocaleString()+"<h2>"+this.state.event.Name+"</h2><p><h3><u>Message from the event organizer</u>:</h3>"+this.state.rsvpMessage+"</body></html>"}},{key:"updateRegistrationInState",value:function(e,t){var n=this;this.setState((function(a){return{registrations:a.registrations.map((function(a){return a.regId===e.regId?n.convertRegistrationData(t):a}))}}))}},{key:"addMessageModal",value:function(){var e=Object(p.a)(v.a.mark((function e(t){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.findRegistrationByRegId(t),e.next=3,this.setState({registration:n,rsvpMessage:n.message,rsvpModalTitle:"RSVP Message",modalTextBoxType:"text"});case 3:this.toggle();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeRsvpMessage",value:function(e){this.setState({rsvpMessage:e.target.value})}},{key:"findRegistrationByRegId",value:function(e){var t=this.state.registrations.filter((function(t){return t.regId===e}));return 1===t.length?t[0]:null}},{key:"canRegisterForEvent",value:function(){return 0===this.state.event.Details.TotalDue&&0===this.state.event.Details.TotalPaid&&0!==this.state.member.id}},{key:"renderRegistrationData",value:function(){return this.state.registrations.map((function(e,t){var n=e.regId,a=e.name,s=e.message,i=e.numGuests;return r.a.createElement("tr",{key:n},r.a.createElement("td",null,a),r.a.createElement("td",null,i),r.a.createElement("td",null,s))}))}},{key:"render",value:function(){var e=this,t=this.state.registrations?this.state.registrations.filter((function(t){return t.memberId===e.state.member.id})):[];return this.state.fetch?r.a.createElement(q,{name:this.props.location.state.name}):this.state.editEvent?j("editEvent",this.state.member,this.state.eventInfo):r.a.createElement("div",null,r.a.createElement(z.Button,{xs:!0,onClick:function(){return e.calendarViewClick()}},"Calendar View"),this.canEdit()&&r.a.createElement(z.Button,{xs:!0,btnStyle:"primary",onClick:function(){return e.handleEditClick()}},"Edit Event"),this.canEdit()&&r.a.createElement(z.Button,{xs:!0,btnStyle:"warning",onClick:function(){return e.handleMessagingClick()}},"Message RSVPd Members"),this.notAlreadyRegistered()&&this.canRegisterForEvent()&&r.a.createElement(z.Button,{xs:!0,btnStyle:"success",onClick:function(){return e.handleRegisterClick()}},"RSVP"),1===t.length&&!this.isUserEventOrganizer()&&r.a.createElement(z.Button,{xs:!0,btnStyle:"danger",onClick:function(){return e.handleUnRegisterClick(t[0].regId)}},"Unregister"),1===t.length&&r.a.createElement(z.Button,{xs:!0,btnStyle:"secondary",onClick:function(){return e.handleAddGuest(t[0].regId)}},"Add Guest"),1===t.length&&r.a.createElement(z.Button,{xs:!0,btnStyle:"secondary",onClick:function(){return e.addMessageModal(t[0].regId)}},"Add/Edit Comment"),r.a.createElement("h2",null,this.state.event.Name),r.a.createElement("div",{className:"event_id"},r.a.createElement("label",null,"Event Id: "),"\xa0\xa0",this.state.event.Id),r.a.createElement("div",{className:"event-title"},r.a.createElement("label",null,"Event Name: "),"\xa0\xa0",this.state.event.Name),r.a.createElement("div",{className:"event-start"},r.a.createElement("label",null,"Event Start Date/Time:"),"\xa0\xa0",new Date(this.state.event.StartDate).toLocaleString()),r.a.createElement("div",{className:"event-end"},r.a.createElement("label",null,"Event End Date/Time:"),"\xa0\xa0",new Date(this.state.event.EndDate).toLocaleString()),r.a.createElement("div",{className:"location"},r.a.createElement("label",null,"Event Location: "),"\xa0\xa0",this.state.event.Location),this.state.organizer&&r.a.createElement("div",{className:"organizer"},r.a.createElement("label",null,"Organizer: "),"\xa0\xa0",this.state.organizer.displayName+"("+this.state.organizer.email+")"),r.a.createElement("div",{className:"descriptionHtml"},r.a.createElement("label",null,"Description: "),r.a.createElement("br",null),"\xa0\xa0",r.a.createElement("div",null,ve()(this.state.event.Details.DescriptionHtml))),r.a.createElement("div",{className:"registrations"},r.a.createElement("label",null,"Registrations: "),r.a.createElement("br",null),r.a.createElement("table",{id:"registrations",className:"table-striped"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"Name"),r.a.createElement("th",{scope:"col"},"#Guests"),r.a.createElement("th",{scope:"col"},"Comments")),this.renderRegistrationData()))),r.a.createElement(pe.a,{show:this.state.modalToggle,onHide:this.toggle,size:"lg",backdrop:"static","aria-labelledby":"contained-modal-title-vcenter",centered:!0},r.a.createElement(pe.a.Header,{closeButton:!0},r.a.createElement(pe.a.Title,{id:"contained-modal-title-vcenter"},this.state.rsvpModalTitle)),r.a.createElement(pe.a.Body,null,r.a.createElement("h4",null,"Please enter your message:"),r.a.createElement("p",null,"textarea"===this.state.modalTextBoxType?r.a.createElement("textarea",{value:this.state.rsvpMessage,className:"form-control",onChange:this.onChangeRsvpMessage}):r.a.createElement("input",{type:"text",value:this.state.rsvpMessage,className:"form-control",onChange:this.onChangeRsvpMessage}))),r.a.createElement(pe.a.Footer,null,r.a.createElement(z.Button,{xs:!0,btnStyle:"danger",onClick:this.toggle},"Cancel"),"textarea"===this.state.modalTextBoxType?r.a.createElement(z.Button,{xs:!0,onClick:function(){return e.handleSendMessage()}},"Send Message"):r.a.createElement(z.Button,{xs:!0,onClick:function(){return e.handleAddMessage()}},"Save"))))}}]),n}(a.Component)),ge=n(8),be=n(62),Ee=n.n(be),De=n(63),Se=n.n(De),ye=n(37),ke=n.n(ye),Oe=(n(250),n(151));Object(ye.registerLocale)("en-GB",Oe.a),Object(ye.setDefaultLocale)("en-GB");var we=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={startDate:null!=a.props.startDate?new Date(a.props.startDate):null,endDate:null!=a.props.endDate?new Date(a.props.endDate):null,maxDate:a.props.endDate?new Date(new Date(a.props.endDate).setHours(23,59,59)):null,minDate:a.props.startDate?new Date(new Date(a.props.startDate).setHours(0,0,0)):null},a.onChangeStartDate=a.onChangeStartDate.bind(Object(Y.a)(a)),a.onChangeStartTime=a.onChangeStartTime.bind(Object(Y.a)(a)),a.onChangeEndTime=a.onChangeEndTime.bind(Object(Y.a)(a)),a}return Object(c.a)(n,[{key:"onChangeStartDate",value:function(){var e=Object(p.a)(v.a.mark((function e(t){var n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()),null!==this.props.endDate){e.next=5;break}return a=new Date(n.getTime()),e.next=5,this.setState({endDate:new Date(a.setHours(23,59,59,0))});case 5:return e.next=7,this.setState({startDate:n,endDate:new Date(this.state.endDate.setFullYear(t.getFullYear(),t.getMonth(),t.getDate())),minDate:new Date(t.setHours(0,0,0,0)),maxDate:new Date(t.setHours(23,59,59,0))});case 7:this.props.onChangeStartDate(this.state.startDate),this.props.onChangeEndDate(this.state.endDate);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeStartTime",value:function(){var e=Object(p.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.endDate<this.state.startDate)){e.next=5;break}return e.next=3,this.setState({startDate:t,endDate:t});case 3:e.next=7;break;case 5:return e.next=7,this.setState({startDate:t});case 7:this.props.onChangeStartDate(this.state.startDate),this.props.onChangeEndDate(this.state.endDate);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeEndTime",value:function(e){this.setState({endDate:e}),this.props.onChangeEndDate(e)}},{key:"componentDidUpdate",value:function(e,t,n){this.state.startDate===t.startDate&&this.state.endDate===t.endDate||this.render()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"dateTimeRangeSelector"},r.a.createElement("div",{className:"dateTimeRangeSelector-date"},r.a.createElement("label",null,this.props.dateLabel),r.a.createElement(ke.a,{selected:this.props.startDate,placeholderText:"Click to select a date",onChange:function(t){return e.onChangeStartDate(t)}})),null!=this.props.startDate?r.a.createElement("div",{className:"dateTimeRangeSelector-start"},r.a.createElement("label",null,this.props.startLabel),r.a.createElement(ke.a,{selected:this.props.startDate,onChange:function(t){return e.onChangeStartTime(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,minTime:this.state.minDate,maxTime:this.state.endDate,timeCaption:"Start Time",dateFormat:"h:mm aa"})):r.a.createElement("div",null),null!=this.props.startDate?r.a.createElement("div",{className:"dateTimeRangeSelector-end"},r.a.createElement("label",null,this.props.endLabel),r.a.createElement(ke.a,{selected:this.props.endDate,onChange:function(t){return e.onChangeEndTime(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,minTime:this.state.startDate,maxTime:this.state.maxDate,timeCaption:"End Time",dateFormat:"h:mm aa"})):r.a.createElement("div",null))}}]),n}(a.Component),xe=(n(308),{link:{link:{decorators:{addTargetToExternalLinks:{mode:"automatic",callback:function(e){return/^(https?:)?\/\//.test(e)},attributes:{target:"_blank",rel:"noopener noreferrer"}}}}}}),Ce=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleStartChange=function(){var e=Object(p.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({date:Object(ge.a)(Object(ge.a)({},a.state.date),{},{date:t})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),console.log("INCOMING PROPS",e),a.state={event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""},isEditing:!0,eventInfo:e.location.state.eventInfo,member:e.location.state.member,fetch:!0},a.onSubmit=a.onSubmit.bind(Object(Y.a)(a)),a.onChangeEventLocation=a.onChangeEventLocation.bind(Object(Y.a)(a)),a.onChangeEventName=a.onChangeEventName.bind(Object(Y.a)(a)),a.startDateHandler=a.startDateHandler.bind(Object(Y.a)(a)),a.endDateHandler=a.endDateHandler.bind(Object(Y.a)(a)),a.handleDelete=a.handleDelete.bind(Object(Y.a)(a)),a}return Object(c.a)(n,[{key:"onSubmit",value:function(e){e.preventDefault(),k(this.state.waToken,this.state.event.Id,this.state.event,(function(e){console.log("UPDATE RESULT",e)})),this.setState({event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""}}),this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"onChangeEventName",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{Name:e.target.value})})}},{key:"onChangeEventLocation",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{Location:e.target.value})})}},{key:"componentDidMount",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)((function(e){return n.setState({waToken:e})}));case 2:if(this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),!this.state.eventInfo.event||!this.state.fetch){e.next=13;break}if(!this.state.eventInfo.event.extendedProps.parentId||!this.state.fetch){e.next=9;break}return e.next=7,w(this.state.waToken,this.state.eventInfo.event.extendedProps.parentId,(function(e){n.setState({event:T(e,n.state.eventInfo.event.id)})}));case 7:e.next=11;break;case 9:return e.next=11,w(this.state.waToken,this.state.eventInfo.event.id,(function(e){n.setState({event:e})}));case 11:e.next=14;break;case 13:this.state.eventInfo.date&&this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{StartDate:new Date(this.state.eventInfo.date)})});case 14:if(this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{StartDate:new Date(this.state.event.StartDate)})}),this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{EndDate:new Date(this.state.event.EndDate)})}),this.setState({fetch:!1}),this.props.location.state.eventInfo.date&&(t=new Date(this.props.location.state.eventInfo.date.getTime()),this.setState(Object(ge.a)(Object(ge.a)({},this.state.event),{},{startDate:this.props.location.state.eventInfo.date})),this.setState(Object(ge.a)(Object(ge.a)({},this.state.event),{},{endDate:new Date(t.setHours(23,59,59))}))),!(this.state.event&&this.state.event.Details&&this.state.event.Details.Organizer)){e.next=22;break}return e.next=21,U(this.state.waToken,this.state.event.Details.Organizer.Id,(function(e){n.setState({organizer:e})}));case 21:console.log("contact",this.state.organizer);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startDateHandler",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{StartDate:e})})}},{key:"endDateHandler",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{EndDate:e})})}},{key:"handleDelete",value:function(){O(this.state.waToken,this.state.event.Id,(function(e){console.log("DELETE RESULT",e)})),this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"calendarViewClick",value:function(){this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"render",value:function(){var e=this;return this.state.fetch?r.a.createElement(q,{name:this.props.location.state.name}):r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"editor"},r.a.createElement("div",{className:"form-group",style:{"text-align":"center"}},r.a.createElement(z.Button,{xs:!0,onClick:function(){return e.calendarViewClick()}},"Calendar View"),r.a.createElement(z.Button,{xs:!0,btnStyle:"danger",onClick:function(){return e.handleDelete()}},"Delete Event")),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Id: "),this.state.event.Id),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Name: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Name,onChange:this.onChangeEventName})),r.a.createElement("div",{className:"form-group"},r.a.createElement(we,{dateLabel:"Event Date: ",startLabel:"Start Time: ",endLabel:"End Time: ",startDate:this.state.event.StartDate,endDate:this.state.event.EndDate,onChangeStartDate:this.startDateHandler,onChangeEndDate:this.endDateHandler})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Location: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Location,onChange:this.onChangeEventLocation})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Description"),r.a.createElement(Ee.a,{config:xe,editor:Se.a,data:this.state.event.Details.DescriptionHtml,onChange:function(t,n){var a=e.state.event.Details;a.DescriptionHtml=n.getData(),e.setState({event:Object(ge.a)(Object(ge.a)({},e.state.event),{},{Details:a})})}})),r.a.createElement("div",{className:"form-group button",style:{"text-align":"center"}},r.a.createElement(z.Button,{xs:!0,btnStyle:"primary",type:"submit"},"Save Event")))))}}]),n}(a.Component),Ie=(n(309),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),a=t.call(this,e),console.log("INCOMING PROPS",e),a.state={event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""},isEditing:!0,eventInfo:e.location.state.eventInfo,member:e.location.state.member,fetch:!0},a.onSubmit=a.onSubmit.bind(Object(Y.a)(a)),a.onChangeEventLocation=a.onChangeEventLocation.bind(Object(Y.a)(a)),a.onChangeEventName=a.onChangeEventName.bind(Object(Y.a)(a)),a.startDateHandler=a.startDateHandler.bind(Object(Y.a)(a)),a.endDateHandler=a.endDateHandler.bind(Object(Y.a)(a)),a}return Object(c.a)(n,[{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var n=Object.assign({},this.state.event);n.StartDate=n.StartDate.toISOString(),n.EndDate=n.EndDate.toISOString(),y(this.state.waToken,n,(function(e){X(t.state.waToken,e,t.state.member.id,(function(e){console.log("INITIAL REG",e)}))})),this.setState({event:{EventType:"Rsvp",StartDate:"",EndDate:"",Location:"",RegistrationEnabled:!0,EndTimeSpecified:!0,RegistrationsLimit:300,Tags:["member-event"],AccessLevel:"Public",Details:{DescriptionHtml:"",Organizer:{Id:0},AccessControl:{AccessLevel:"Public",AvailableForAnyLevel:!1,AvailableForLevels:[],AvailableForAnyGroup:!1,AvailableForGroups:[]},GuestRegistrationSettings:{Enabled:!0,CreateContactMode:"NeverCreateContact"}},Name:""}}),this.props.history.push("/?mid=".concat(this.state.member.id))}},{key:"onChangeEventName",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{Name:e.target.value})})}},{key:"onChangeEventLocation",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{Location:e.target.value})})}},{key:"componentDidMount",value:function(){var e=Object(p.a)(v.a.mark((function e(){var t,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.a)((function(e){return n.setState({waToken:e})}));case 2:this.setState({member:this.props.location.state.member,eventInfo:this.props.location.state.eventInfo}),console.log("STATE",this.state),this.state.eventInfo.date?(this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{StartDate:new Date(new Date(this.state.eventInfo.date).setHours(8,0,0))})}),this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{EndDate:new Date(new Date(this.state.eventInfo.date).setHours(20,0,0))})})):(this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{StartDate:null})}),this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{EndDate:null})})),this.setState({fetch:!1}),(t=Object.assign({},this.state.event.Details)).Organizer={Id:this.state.member.id},this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{Details:t})});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startDateHandler",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{StartDate:e})})}},{key:"endDateHandler",value:function(e){this.setState({event:Object(ge.a)(Object(ge.a)({},this.state.event),{},{EndDate:e})})}},{key:"componentDidUpdate",value:function(e,t,n){this.state.event.StartDate===t.event.StartDate&&this.state.event.EndDate===t.event.EndDate||this.render()}},{key:"calendarViewClick",value:function(){this.props.history.push("/?mid=".concat(this.state.member.id)),console.log("CAL VIEW",this.state.member)}},{key:"render",value:function(){var e=this;return this.state.fetch?r.a.createElement(q,{name:this.props.location.state.name}):r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"editor"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group",style:{"text-align":"center"}},r.a.createElement(z.Button,{xs:!0,onClick:function(){return e.calendarViewClick()}},"Calendar View")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Name: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Name,onChange:this.onChangeEventName})),r.a.createElement("div",{className:"form-group"},r.a.createElement(we,{dateLabel:"Event Date: ",startLabel:"Start Time: ",endLabel:"End Time: ",startDate:this.state.event.StartDate,endDate:this.state.event.EndDate,onChangeStartDate:this.startDateHandler,onChangeEndDate:this.endDateHandler})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Event Location: "),r.a.createElement("input",{type:"text",className:"form-control",value:this.state.event.Location,onChange:this.onChangeEventLocation})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Description"),r.a.createElement(Ee.a,{editor:Se.a,data:this.state.event.Details.DescriptionHtml,onChange:function(t,n){var a=e.state.event.Details;a.DescriptionHtml=n.getData(),e.setState({event:Object(ge.a)(Object(ge.a)({},e.state.event),{},{Details:a})})}})),r.a.createElement("div",{className:"form-group",style:{"text-align":"center"}},r.a.createElement(z.Button,{xs:!0,btnStyle:"primary",type:"submit"},"Create Event")))))}}]),n}(a.Component)),Te=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleEventsChange=function(e){a.setState({events:e})},a.state={events:[]},a}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(h.a,{basename:"/"},r.a.createElement("div",{className:"App container-fluid"},r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",render:function(t){return r.a.createElement(W,Object.assign({},t,{onEventChange:e.handleEventsChange,events:e.state.events}))}}),r.a.createElement(d.b,{exact:!0,path:"/showEvent",component:fe}),r.a.createElement(d.b,{exact:!0,path:"/editEvent",component:Ce}),r.a.createElement(d.b,{exact:!0,path:"/createEvent",component:Ie}))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},33:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var a=n(5),r=n.n(a),s=n(9),i=n(47),o=n(178),c=function(){var t=Object(s.a)(r.a.mark((function t(n){var a,s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="Basic "+new e("APIKEY:mf8q984b3zem9x5r6rk19yg37ht6uz").toString("base64"),s={grant_type:"client_credentials",scope:"auto",obtain_refresh_token:!0},t.next=4,i({method:"POST",url:"https://cors-anywhere.herokuapp.com/https://oauth.wildapricot.org/auth/token",data:o.stringify(s),headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:a}}).then((function(e){n(e.data)})).catch((function(e){console.log("error",e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}).call(this,n(54).Buffer)}},[[152,1,2]]]);
//# sourceMappingURL=main.33b6c6ac.chunk.js.map